%------------------------------------------------------------------------------
% Template file for the submission of papers to IUCr journals in LaTeX2e
% using the iucr document class
% Copyright 1999-2013 International Union of Crystallography
% Version 1.6 (28 March 2013)
%------------------------------------------------------------------------------

\documentclass[pdf]{iucr}              % DO NOT DELETE THIS LINE
\RequirePackage{graphicx}
\RequirePackage{url}
\voffset=-0.5in
\RequirePackage{siunitx}

     %-------------------------------------------------------------------------
     % Information about journal to which submitted
     %-------------------------------------------------------------------------
     \journalcode{J}              % Indicate the journal to which submitted
                                  %   A - Acta Crystallographica Section A
                                  %   B - Acta Crystallographica Section B
                                  %   C - Acta Crystallographica Section C
                                  %   D - Acta Crystallographica Section D
                                  %   E - Acta Crystallographica Section E
                                  %   F - Acta Crystallographica Section F
                                  %   J - Journal of Applied Crystallography
                                  %   M - IUCrJ
                                  %   S - Journal of Synchrotron Radiation

\begin{document}                  % DO NOT DELETE THIS LINE

     %-------------------------------------------------------------------------
     % The introductory (header) part of the paper
     %-------------------------------------------------------------------------

     % The title of the paper. Use \shorttitle to indicate an abbreviated title
     % for use in running heads (you will need to uncomment it).

\title{Introducing classical molecular dynamics simulation to users of
scattering}
\shorttitle{Simulation and scattering}

     % Authors' names and addresses. Use \cauthor for the main (contact)
     % author.
     % Use \author for all other authors. Use \aff for authors' affiliations.
     % Use lower-case letters in square brackets to link authors to their
     % affiliations; if there is only one affiliation address, remove the [a].

\cauthor[a,b]{Andrew R.}{McCluskey}{a.r.mccluskey@bath.ac.uk}{}
\author[a]{Adam R.}{Symington}
\author[c]{James}{Grant}
\author[a]{Benjamin J.}{Morgan}
\author[a]{Stephen C.}{Parker}
\cauthor[a]{Karen J.}{Edler}{k.edler@bath.ac.uk}

\aff[a]{Department of Chemistry, University of Bath, Claverton Down, Bath,
BA2 7AY \country{UK}}
\aff[b]{Diamond Light Source, Diamond House, Rutherford Appleton Laboratory,
Harwell Oxford, OX11 0DE, \country{UK}}
\aff[c]{Department of Chemistry, University of Bath, Claverton Down, Bath,
BA2 7AY \country{UK}}

     % Use \shortauthor to indicate an abbreviated author list for use in
     % running heads (you will need to uncomment it).

\shortauthor{McCluskey, Symington, Grant, Morgan, Edler, and Parker}

     % Use \vita if required to give biographical details (for authors of
     % invited review papers only). Uncomment it.

%\vita{Author's biography}

     % Keywords (required for Journal of Synchrotron Radiation only)
     % Use the \keyword macro for each word or phrase, e.g.
     % \keyword{X-ray diffraction}\keyword{muscle}

%\keyword{keyword}

     % PDB and NDB reference codes for structures referenced in the article and
     % deposited with the Protein Data Bank and Nucleic Acids Database (Acta
     % Crystallographica Section D). Repeat for each separate structure e.g
     % \PDBref[dethiobiotin synthetase]{1byi} \NDBref[d(G$_4$CGC$_4$)]{ad0002}

%\PDBref[optional name]{refcode}
%\NDBref[optional name]{refcode}

\maketitle                        % DO NOT DELETE THIS LINE

\begin{synopsis}
We describe an open educational resource for the introduction of classical molecular dynamics to the users of scattering techniques.
The purpose of this is to enable scattering domain experts to learn about these simulation techniques.
The better understanding that this will facilitate in the users will allow for better application of these techniques as an aspect of multi-modal analysis for scattering data.
\end{synopsis}

\begin{abstract}
Classical molecular dynamics simulations are becoming a popular technique for the multi-modal analysis of scattering techniques; such as small angle scattering and diffraction.
However, few users of these techniques have formalised training in these methodologies, resulting in frequent use of molecular dynamics simulations as a black box technique.
This work discusses an open educational resource designed to introduce classical molecular dynamics to users of scattering, describing possible sources of error in the method.
Furthermore, we cover some of the methods that can be used to enable simulation techniques to facilitate in the analysis of scattering data.
\end{abstract}


     %-------------------------------------------------------------------------
     % The main body of the paper
     %-------------------------------------------------------------------------
     % Now enter the text of the document in multiple \section's, \subsection's
     % and \subsubsection's as required.

\section{Introduction}

The use of molecular dynamics simulations to aid in the analysis of experimental data; particular from small angle scattering and diffraction, has grown significantly over the past ten years \cite{Pan2012,Boldon2015,Hub2018,Ivanovic2018,East2016,Wall2014,Wall2018,Satoh2015}.
Figure \ref{fig:growth} shows the growth in the percentage of small angle scattering (SAS) publications that mention molecular dynamics.
It can be seen that there has been a linear growth in such publications, with more than \SI{20}{\percent} of all SAS publications mentioning molecular dynamics as of 2018.
This alone is a clear indication of the importance simulation techniques are having on the field of scattering and diffraction.

Usually users of small angle scattering and diffraction techniques have a background in experimental science, with little to no formalised training in computational modelling.
This is particularly problematic, as it leads to some users treating molecular simulation as a black-box, using tools such as WAXSiS or SASSIE \cite{Chen2014,Knight2015,Perkins2016}.
Use of molecular simulation without a solid understanding of the fundamentals can lead to the inclusion of severe systematic errors.

Recently, there has been a growth in courses that introduce the background of molecular simulation alongside the use of the packages mentioned above.
For example, the annual ISIS Neutron Training Course now includes an ``Introduction to Molecular Dynamics for Neutron Scattering'' course, which details the fundamentals of classical molecular dynamics simulation, before detailing some previous applications in neutron science and allowing the student to gain a familiarity with the SASSIE software.
However, courses such as the ISIS Neutron Training Course are limited both in numbers and location meaning not all users of molecular simulation based software packages are able to easy access them.

The utility of learning options is also limited by availability, in order to reduce that need there has been a movement towards technology enhanced open educational resources (OER).
The use of the Jupyter Notebook framework \cite{Kluyver2016} has facilitated this by allowing direct student interaction with the learning resources using, often but not always, the Python programming language.

The work herein describes an online, open-source, interactive module to introduce members from the scattering and diffraction communities to molecular dynamics simulations.
This course follows six lessons, covering classical methods and introducing molecular dynamics methods.
Then the Python library pylj \cite{McCluskey2018} is used to introduce the interaction between molecular dynamics simulation and scattering/diffraction in the context on the Debye equation \cite{Debye1915}.
We will discuss implementation and detail how the student, regardless of career position, can get the most from the module.

\section{Assumed prior knowledge}

The interaction between simulation and scattering course makes use of the Python programming language to give interactive examples for the mathematical and algorithmic content.
Therefore some knowledge, or willingness to learn, Python is desired.
However, we have aimed to write the course in such a fashion that in depth Python knowledge is not required.
Some knowledge of undergraduate chemistry or physics is necessary to fully understand the nature of the classical interaction potentials.
Furthermore, the level of mathematics required for an undergraduate science degree is assumed.

\section{Module construction}

The module is currently hosted online at \url{https://arm61.github.io/sim_and_scat}.
A Jupyter Notebook based course building system developed at the University of Bath was used to allow the course to be written as a series of Jupyter Notebooks, which are then compiled into the webpages.
This allowed Python code blocks to be built into the lessons to show algorithmic details in practice.

The expectation is that the user would use the online material alongside a Jupyter Notebook running locally (installation of this is detailed in the introduction to the course).
This would allow the user to copy the Python code from the webpages, run it locally, and alter it as they see fit.

The module is licensed under CC-BY-SA-4.0, and is therefore a contribution to the growing library of open educational resources.
The open-source nature of this license means that particularly interested parties are able to easily use the module to enhance their own educational platform.
Additionally, experts in the field may wish to contribute to it, or fork their own version that may grow independently.
The source code is available at \url{https://github.com/arm61/sim_and_scat}.


\section{Module outline}

The module follows a simple outline, with code blocks that gradually build up the students understanding of the concepts.

\subsection{Getting started}

The first page, nominally Lesson 0, introduces the course and outlines the content.
It also gives directions on how to install the necessary software, namely Anaconda Python, and the pylj package \cite{McCluskey2018}, and launch the Jupyter Notebook interface \cite{Kluyver2016}.
It is important that this is introduced early in the module such that students can immediately be actively involves in the interactive experience of the lessons.

\subsection{Classical methods}

Once the students computer is able to run the necessary software, concepts of classical simulation methods are introduced.
These include the nature of potential models and show some examples such as the Lennard-Jones and Buckingham potentials \cite{LennardJones1924,Buckingham1938}.
The course gives a brief description of how a potential model is determined, including mention to the parameterisation from higher accuracy quantum mechanical calculations.
The existence of off-the-shelf potential models is mentioned alongside a discussion of the problems associated with these as they also may require system specific optimisation.
Finally, we mention mixing rules for off-the-shelf potential models, and again discuss possible problems that a user may encounter related to system specificity.

\subsection{Molecular dynamics}

Once the basics of classical methods have been introduced, the student is presented with molecular dynamics.
This is shown by gradually building up a one-dimension molecular dynamics simulation using the Velocity-Verlet algorithm \cite{Swope1982} and the Lennard-Jones potential model \cite{LennardJones1924}.
This begins by detailing the requirement to find the forces on the particles, before introducing how the acceleration is determined for each particle.
Finally, the different aspects of the determination of the particle positions and velocities using the Velocity-Verlet algorithm are outlined.

\subsection{pylj and the interaction with scattering}

The final aspect of the module makes use of the Python package pylj \cite{McCluskey2018}.
This is a open-source package designed to introduce students to classical atomistic simulation.
First, the student is given a working pylj molecular dynamics simulation to run on locally, then they are shown how to use the custom plot functionality of pylj to present information about the simulation.
In the final lesson, the Debye equation is introduced and the students are shown how to implement it within pylj.
Using pylj, the students may then observe the effect of temperature on both the structure of the argon particles, in addition to the scattering profile that is generated from the Debye equation.
Finally, we mention the algorithms that may be used to improve the efficiency of the calculation of the scattering profile, such as the Fibonacci sequence or the Golden Vectors method \cite{Svergun1994, Watson2013}.

\section{Future outlook}

In future, we hope that the open-source nature of the module will allow interested parties to use and build upon it.
Furthermore, we welcome student input to improve implementation and pedagogical aspects of the module.
We hope to use this module within teaching at courses such as the ISIS Neutron Training Course and the Diamond SAS workshop, from which feedback may be obtained directly.


     % Appendices appear after the main body of the text. They are prefixed by
     % a single \appendix declaration, and are then structured just like the
     % body text.

%\appendix
%\section{Appendix title}

%Text text text text text text text text text text text text text text
%text text text text text text text.

%\subsection{Title}

%Text text text text text text text text text text text text text text
%text text text text text text text.

%\subsubsection{Title}

%Text text text text text text text text text text text text text text
%text text text text text text text.


     %-------------------------------------------------------------------------
     % The back matter of the paper - acknowledgements and references
     %-------------------------------------------------------------------------

     % Acknowledgements come after the appendices

\ack{A. R. M. is grateful to the University of Bath and Diamond Light Source for co-funding a studentship (Studentship Number STU0149).
B. J. M. acknowledges support from the Royal Society (Grant No. UF130329).}

     % References are at the end of the document, between \begin{references}
     % and \end{references} tags. Each reference is in a \reference entry.

%\begin{references}
\bibliographystyle{iucr}
\bibliography{iucr.bib}
%\end{references}

     %-------------------------------------------------------------------------
     % TABLES AND FIGURES SHOULD BE INSERTED AFTER THE MAIN BODY OF THE TEXT
     %-------------------------------------------------------------------------

     % Simple tables should use the tabular environment according to this
     % model

%\begin{table}
%\caption{Caption to table}
%\begin{tabular}{llcr}      % Alignment for each cell: l=left, c=center, r=right
% HEADING    & FOR        & EACH       & COLUMN     \\
%\hline
% entry      & entry      & entry      & entry      \\
% entry      & entry      & entry      & entry      \\
% entry      & entry      & entry      & entry      \\
%\end{tabular}
%\end{table}
%
\begin{figure}
\caption{The annual growth of the percentage of publication that mention ``small angle scattering'' which also mention ``molecular dynamics. Determined from the number of results from a Google Scholar search.}
\label{fig:growth}
\includegraphics[width=\textwidth]{figures/chem_data_py.pdf}
\end{figure}
%


\end{document}                    % DO NOT DELETE THIS LINE
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
